<?xml version="1.0" encoding="utf-8" ?>
<page:BasePage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:page="clr-namespace:EcoPlatesMobile.Views"
               xmlns:component="clr-namespace:EcoPlatesMobile.Views.Components"
               xmlns:language="clr-namespace:EcoPlatesMobile.Resources.Languages"
               xmlns:view="clr-namespace:EcoPlatesMobile.Views.Components"
               x:Class="EcoPlatesMobile.Views.Chat.ChatedUserPage"
               BackgroundColor="White">
    
    <Grid RowDefinitions="Auto, *">
        <component:CustomHeader x:Name="header"
                                Title="{x:Static language:AppResource.Message}"
                                HeaderBackground="{StaticResource Company}"/>
        <RefreshView x:Name="listProduct"
                     IsRefreshing="{Binding IsRefreshing}"
                     Command="{Binding RefreshCommand}"
                     Margin="10"
                     Grid.Row="1">
                <CollectionView ItemsSource="{Binding Users}">
                <CollectionView.EmptyView>
                    <ContentView>
                        <ContentView.Triggers>
                            <DataTrigger TargetType="ContentView"
                                         Binding="{Binding IsLoading}"
                                         Value="True">
                                <Setter Property="IsVisible" Value="False" />
                            </DataTrigger>
                            <DataTrigger TargetType="ContentView"
                                         Binding="{Binding IsRefreshing}"
                                         Value="True">
                                <Setter Property="IsVisible" Value="False" />
                            </DataTrigger>
                        </ContentView.Triggers>
                        <view:EmptyViewText/>
                    </ContentView>
                </CollectionView.EmptyView>
                <CollectionView.ItemsLayout>
                        <GridItemsLayout Orientation="Vertical" 
                                         VerticalItemSpacing="10"
                                         HorizontalItemSpacing="10"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <!--<SwipeView>
                                <SwipeView.RightItems>
                                    <SwipeItems>
                                        <SwipeItem Text="{x:Static language:AppResource.Edit}"
                                                   BackgroundColor="{StaticResource Company}"
                                                   Invoked="EditProduct_Invoked"/>
                                        <SwipeItem Text="{x:Static language:AppResource.Inactive}"
                                                   BackgroundColor="Red"
                                                   Invoked="NoActiveProduct_Invoked"/>
                                    </SwipeItems>
                                </SwipeView.RightItems>
                            </SwipeView>-->
                            <Grid ColumnDefinitions="Auto, *, Auto"
                                  Margin="10,5,10,0">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer NumberOfTapsRequired="1"
                                                      Tapped="User_Tapped"/>
                            </Grid.GestureRecognizers>
                                <Border WidthRequest="50"
                                        HeightRequest="50"
                                        Stroke="Gray"
                                        StrokeThickness="0.2"
                                        StrokeShape="RoundRectangle 100"
                                        HorizontalOptions="Center"
                                        VerticalOptions="Center"
                                        Margin="0,0,20,0">
                                    <Image Source="{Binding UserImage}"
                                           Aspect="AspectFill"
                                           WidthRequest="64"
                                           HeightRequest="64"/>
                                </Border>
                                <Label Text="{Binding UserName}"
                                       TextColor="Black"
                                       FontSize="16"
                                       FontFamily="RobotoVar"
                                       VerticalOptions="Center"
                                       HorizontalOptions="Start"
                                       LineBreakMode="WordWrap"
                                       Grid.Column="1"/>
                                <Image Source="{Binding RightImage}"
                                       Aspect="AspectFit"
                                       WidthRequest="20"
                                       HeightRequest="20"
                                       VerticalOptions="Center"
                                       Grid.Column="2"/>
                        </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </RefreshView>
        <ActivityIndicator x:Name="loading" 
                           IsRunning="{Binding IsLoading}"
                           Color="{StaticResource User}"
                           Scale="1.5"
                           VerticalOptions="Center"
                           HorizontalOptions="Center"
                           Grid.RowSpan="2"/>
    </Grid>
</page:BasePage>